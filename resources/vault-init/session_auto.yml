version: "0.3"
predecessor: ba8682e20b6aaadd38056ff44fd5aa4abce742c7c622784daef51828e2342308
name: vault-init-auto
services:
   - name: dev
     image_name: sconecuratedimages/www2019:vault-1.5.0-alpine
     mrenclaves: [da24079c4a5f4d47ca8f450b38f9bdc00f8bb3660506d852b66a1b61b666ea18]
     command: /root/go/bin/vault-init auto
     pwd: /
     environment:
        SCONE_MODE: hw
        PASSPHRASE1: $$SCONE::pasphrase1$$
secrets:
    - name: gpg_private_from_parent1
      import:
        session: demo-parent1
        secret: gpg_private_key1
    - name: gpg_public_from_parent1
      import:
        session: demo-parent1
        secret: gpg_public_key1
    - name: pasphrase1
      import:
        session: demo-parent1
        secret: pasphrase1
        
images:
    - name: sconecuratedimages/www2019:vault-1.5.0-alpine
      injection_files:
       - path: /root/go/bin/resources/vault/vault-experiments/keys/private.asc
         content: |
           $$SCONE::gpg_private_from_parent1$$
       - path: /root/go/bin/resources/vault/vault-experiments/keys/public.asc
         content: |
           $$SCONE::gpg_public_from_parent1$$
    
security:
  attestation:
    tolerate: [debug-mode, outdated-tcb]
    ignore_advisories: "*"
