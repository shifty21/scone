version: "0.3"
predecessor: 90a2369e3226341f9c68a35c10572a921e5121399d3a443ece476c9b1ca06091
name: mongodb
services:
- name: init
  image_name: mongodb-setup-image
  mrenclaves:
  - 359766728eeb15b6a298611a21e97be4cf740ca898ab409fa4f36b4c017462dc
  command: /usr/bin/mongod --dbpath /usr/local/var/mongodb
  pwd: /
  environment:
    SCONE_MODE: hw
- name: auth
  image_name: mongodb-setup-image
  mrenclaves:
  - 359766728eeb15b6a298611a21e97be4cf740ca898ab409fa4f36b4c017462dc
  command: /usr/bin/mongod -auth --bind_ip=0.0.0.0 --dbpath /usr/local/var/mongodb
  pwd: /
  environment:
    SCONE_MODE: hw
security:
  attestation:
    tolerate:
    - debug-mode
    - outdated-tcb
    ignore_advisories: '*'
secrets:
  - name: my_ca_certificate
    kind: x509-ca
    private_key: my_server_certificate_private_key
    common_name: "My own CA"
  - name: my_server_certificate_private_key
    kind: private-key
  - name: mongodb_certificates
    kind: x509
    private_key: my_server_certificate_private_key
    issuer: my_ca_certificate
    common_name: "tu-dresden"
    valid_for: 90 days
    endpoint: server
    dns:
      - tudresden.de
    export:
      - session: env-print